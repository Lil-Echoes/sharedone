<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="pricens">

	<select id="priceList" resultType="price">
		SELECT pc.*,b.buyerNM,pd.productNM FROM price pc, M_buyer b, m_product pd WHERE pc.del='n' and pc.buyerCD=b.buyerCD and pc.productCD=pd.productCD
		ORDER BY periodStart
	</select>
	
	<select id="priceDetail" parameterType="String" resultType="price">
		SELECT pc.*,b.buyerNM,pd.productNM FROM price pc, M_buyer b, m_product pd WHERE pc.buyerCD=b.buyerCD and pc.productCd=pd.productCd and buyerCD = #{buyerCD} and productCD = #{productCD} and periodStart = #{periodStart}
	</select>
	
	<update id="pricetUpdate" parameterType="price">
		UPDATE price SET buyerNM=#{buyerNM} and productNM=#{productNM} and periodStart=#{periodStart} and listPrice=#{listPrice} and currency=#{currency} FROM price pc, M_buyer b, m_product pd WHERE pc.buyerCD=b.buyerCD and pc.productCd=pd.productCd and buyerCD = #{buyerCD} and productCD = #{productCD} and periodStart = #{periodStart}
	</update>
	
	<delete id="priceDelete" parameterType="map">
		DELETE price WHERE buyerCD=#{buyerCD} and productCD=#{productCD} and periodStart=#{periodStart}
	</delete>
	
	<insert id="priceInsert" parameterType="price">
		INSERT INTO price VALUES (#{buyerCD}, #{productCD}, #{periodStart}, #{listPrice}, #{currency}, 'n') FROM price pc, M_buyer b, m_product pd WHERE pc.buyerCD=b.buyerCD and pc.productCd=pd.productCd and buyerCD = #{buyerCD} and productCD = #{productCD}
	</insert>
	
	<select id="delList" parameterType="string" resultType="string">
		select del from price where buyerCD=#{buyerCD} and productCD=#{productCD} and periodStart=#{periodStart}
	</select>
	
	<update id="deletePrice" parameterType="map">
		update price set del=#{delList} where buyerCD=#{buyerCD} and productCD=#{productCD} and periodStart=#{periodStart}
	</update>
	
</mapper>